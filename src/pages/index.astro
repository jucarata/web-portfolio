---
// Página principal del portfolio
import "../styles/global.css";
import "../styles/animations/curtains.css";
import "../styles/animations/work.css";
import Navbar from "../components/Navbar.astro";
import ProjectModal from "../components/ProjectModal.astro";
import { Linkedin, Github, Mail, FileDown } from "@lucide/astro";
import { projects } from "../consts/projects.js";

// Función helper para construir rutas con base path
const getImageUrl = (path) => {
  const base = import.meta.env.BASE_URL || '';
  // Si la ruta ya tiene el base path, no duplicarlo
  if (path.startsWith(base)) {
    return path;
  }
  // Construir la ruta completa con base path
  const cleanPath = path.startsWith('/') ? path : '/' + path;
  const basePath = base.endsWith('/') ? base.slice(0, -1) : base;
  return basePath + cleanPath;
};

// Construir URLs de imágenes con base path
const projectsWithUrls = projects.map(project => ({
  ...project,
  image_url: getImageUrl(project.image_url)
}));
---

<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Jucara - Portfolio</title>
  </head>
  <body>
    <Navbar />
    <ProjectModal />
    <main class="home" id="home">
      <div class="curtains-container" id="curtains">
        <div class="curtain curtain-left"></div>
        <div class="curtain curtain-right"></div>
      </div>
      <div class="container">
        <div class="greeting">
          <h1 class="greeting-text">Hola, soy</h1>
          <h2 class="brand-name">Jucara</h2>
        </div>
        <div class="social-links" aria-label="Redes de contacto">
          <a class="social-link" href="https://www.linkedin.com/in/jucarata/" aria-label="LinkedIn" target="_blank" rel="noopener noreferrer">
            <Linkedin size={22} strokeWidth={1.8} />
          </a>
          <a class="social-link" href="https://github.com/jucarata" aria-label="GitHub" target="_blank" rel="noopener noreferrer">
            <Github size={22} strokeWidth={1.8} />
          </a>
          <a class="social-link" href="mailto:juancaram21@gmail.com" aria-label="Correo">
            <Mail size={22} strokeWidth={1.8} />
          </a>
          <a class="social-link" href="#" aria-label="Descargar CV">
            <FileDown size={22} strokeWidth={1.8} />
          </a>
        </div>
      </div>
    </main>
    <!-- Sección Work -->
    <section class="content-section" id="work">
      <div class="section-content">
        <h2 class="section-title">WORK</h2>
        <div class="work-carousel work-marquee" aria-label="Proyectos">
          <div class="work-track work-track-marquee">
            {projectsWithUrls.map((project, index) => (
              <article class="work-card" data-project-index={index}>
                <div class="work-image">
                  <img src={project.image_url} alt={`Proyecto ${project.name}`} loading="lazy" />
                </div>
                <h3 class="work-title">{project.name}</h3>
              </article>
            ))}
            {projectsWithUrls.map((project) => (
              <article class="work-card" aria-hidden="true">
                <div class="work-image">
                  <img src={project.image_url} alt="" loading="lazy" />
                </div>
                <h3 class="work-title">{project.name}</h3>
              </article>
            ))}
          </div>
        </div>
      </div>
    </section>
    <!-- Sección Contact -->
    <section class="content-section" id="contact">
      <div class="section-content">
        <h2 class="section-title">Contact</h2>
        <p class="section-text">Aquí irá tu información de contacto...</p>
      </div>
    </section>
    <script>
      import { initAll } from "../scripts/main.js";
      initAll();
    </script>
  </body>
</html>
